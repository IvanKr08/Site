<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ru">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>IvanKr08 - Эмулятор MOS-6502</title>
		<link rel="shortcut icon" href="gfx/favicon.gif">
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<!-- MAIN TABLE +-->
		<table class="maintable" align="center">
		<tbody>
			<!-- MENU +-->
			<tr><td class="menu" align="center">
				<a href="index.html">Главная</a>
				<span>|</span>
				<a href="img.html">Галерея</a>
				<span>|</span>
				<a href="intr.html">Интересное</a>
			</td></tr>
			<!-- ==== +-->
			
			<!-- MAIN +-->
			<tr><td class="main">
			<table cellpadding="4">
			<tbody>
				<!-- TITLE +-->
				<tr><td align="center">
					<h1>Эмулятор MOS-6502</h1>
					<hr>
				</td></tr>
				<!-- ===== +-->

				<!-- 6502 +-->
				<tr><td align="left">
					<div class="pfaar" align="center">
						<img src="pfaa/6502.gif" alt="*Окна эмулятора"><br>
						<i>Пример вывода одной из программ<br>Ниже информация о регистрах</i>
						<hr>
					</div>
					<h2 class="hnarrow">Вступление</h2>
					Относительно старый проект, начатый еще в конце февраля 2023 года. Это эмулятор процессора MOS-6502, написанный на C# с нуля, используя только документацию
					по инструкциям и список аппаратных ошибок. За 2 недели удалось добиться идеальной работы <i>практически</i> всех программ с <a href="http://txt3.de/">этого</a> сайта.
					Но, несколько из них работали некорректно, и у меня никак не получалось сузить круг поиска, как и найти источник ошибки.
					В конечном итоге я занялся переводом программы на нормальный вывод изображения, без использования меееедленной консольной псевдографики,
					поисками идеальной графической библиотеки под C#, переписыванием всей архитектуры и прочей фигней, главное, что не поиском ошибки.
					В начале лета все действо окончательно и бесповоротно заглохло. А ведь, по сути, оставалось только найти одну маленькую ошибку и дописать
					обработку длительности выполнения опкодов (В 6502 они жестко фиксированы, и, например, видеоконтроллер Apple II целиком опирается на эту особенность).
					
					<h3>Использование</h3>
					Данный процессор достаточно сильно повлиял на всю компьютерную историю, и, к примеру, стоял в
					Commodore PET, Commodore 64, Apple I, Apple II, Atari 2600, Nintendo NES, Советском АГАТ, Правец 8 и
					в бесчисленном количестве других устройств, ибо очень дешево (ОЗУ тех ПК обычно стоила в раза 3 дороже) и <i>относительно</i> быстро.
					В СССР, конечно, большее распространение получил Z80, стоявший в каждом клоне Spectrum и в большинстве тамошних принтеров
					(В том числе в моем Robotron K6312M из ГДР), и производившийся на целой армии заводов по всей восточной европе и территории СССР.
					
					<p>
					Из интересных фактов можно подметить то, что мозги T800 из Терминатора, вероятно, работают на какой-то вариации 6502, судя по "виду от первого лица".
					Помимо этого, робот Бендер из Футурамы также основан на этом сорте калькуляторов, что показывается в одном из выпусков.
					</p>
					
					<h2>Послесловие</h2>
					Скачать исходник и EXE можно <a href="files/6502Emu.zip">тут</a>.
					Архитектура изначально была неправильная, как и выбор языка.
					Сам по себе C# не слишком быстр для таких целей, а если обернуть критические части в switch и таблицу делегатов,
					то такая идея, ясное дело, ничем хорошим не кончится.
					На моем ПК (AMD Ryzen 5 2600) в отладочной конфигурации выходит ~5 миллионов операций в секунду (В релизе вплоть до 50), настоящие же работали в основном на 1ом-3х МГц, что при желании можно пересчитать в операции.
					SFML был прикручен в последнии дни +- нормальной разработки и не до конца, поэтому весь ввод через консоль,
					а само окно SFML в некоторых сценариях лишается цикла обработки сообщений, что приводит к его зависанию.
					Эта версия содержит лишь небольшие исправления в Program.cs, остальной код остался еще с весны.
					
					<p>
					Из интересных статьей я могу порекомендовать <a href="https://en.wikipedia.org/wiki/MOS_Technology_6502">википедию</a> (Английский),
					Habr <a href="https://habr.com/ru/articles/674940/">раз</a>, <a href="https://habr.com/ru/articles/499464/">два</a>, а так же <a href="http://www.6502.org/">этот сайт</a>.
					</p>
				</td></tr>
				<!-- ==== +-->
			</tbody>
			</table>
			</td></tr>
			<!-- ==== +-->
			
			<!-- FOOTER +-->
			<tr><td class="footer" align="center">
				<!-- INFORMERS +-->
				<a href="http://links.twibright.com/">
				<img src="./informers/links.gif" alt="LinksBrowser"></a>
				
				<a href="https://files.scene.org/">
				<img src="./informers/amigademo.gif" alt="AmigaDemo"></a>
				
				<a href="https://rn10950.github.io/RetroZillaWeb/">
				<img src="./informers/retrozilla.gif" alt="RetroZilla"></a>
				
				<img src="./informers/css.gif" alt="">
				
				<a href="https://modarchive.org/index.php">
				<img src="./informers/modarchive.gif" alt="ModArchive"></a>
				
				<img src="./informers/npp.gif" alt="">
				
				<a href="https://openmpt.org/">
				<img src="./informers/openmpt.gif" alt="OpenMPT"></a>
				
				<img src="./informers/chrome.gif" alt="">
				
				<a href="https://www.haiku-os.org/">
				<img src="./informers/haikuos.gif" alt="HaikuOS"></a>
				<!-- ========= +-->
				
				<h2 align="center" style="margin: 0">Здесь пока ничего нет, но вы держитесь!</h2>
				Программист - это человек, который сначала долго думает, чтобы потом ничего не делать. (C)
			</td></tr>
			<!-- ====== +-->
		</tbody></table>
		<!-- ========== +-->
	</body>
</html>
